import pytz
import subprocess

# Function to set the system's timezone on Windows
def set_system_timezone_windows(timezone):
    try:
        # Set the system timezone using the 'tzutil' command
        subprocess.call(['tzutil', '/s', timezone])
        print("System timezone set to", timezone)
    except Exception as e:
        print("Error setting system timezone:", str(e))

# Assuming you have retrieved the proxy country as 'proxy_country'
proxy_country = 'Pakistan'

# Map proxy country to corresponding timezone
country_timezones = {'Afghanistan': 'Afghanistan Standard Time', 'Åland Islands': 'FLE Standard Time', 'Albania': 'Central Europe Standard Time', 'Algeria': 'W. Central Africa Standard Time', 'American Samoa': 'UTC-11', 'Andorra': 'W. Europe Standard Time', 'Angola': 'W. Central Africa Standard Time', 'Anguilla': 'SA Western Standard Time', 'Antarctica': 'Pacific SA Standard Time', 'Antigua and Barbuda': 'SA Western Standard Time', 'Argentina': 'Argentina Standard Time', 'Armenia': 'Caucasus Standard Time', 'Aruba': 'SA Western Standard Time', 'Australia': 'AUS Eastern Standard Time', 'Austria': 'W. Europe Standard Time', 'Azerbaijan': 'Azerbaijan Standard Time', 'Bahamas, The': 'Eastern Standard Time', 'Bahrain': 'Arab Standard Time', 'Bangladesh': 'Bangladesh Standard Time', 'Barbados': 'SA Western Standard Time', 'Belarus': 'Belarus Standard Time', 'Belgium': 'Romance Standard Time', 'Belize': 'Central America Standard Time', 'Benin': 'W. Central Africa Standard Time', 'Bermuda': 'Atlantic Standard Time', 'Bhutan': 'Bangladesh Standard Time', 'Bolivarian Republic of Venezuela': 'Venezuela Standard Time', 'Bolivia': 'SA Western Standard Time', 'Bonaire, Sint Eustatius and Saba': 'SA Western Standard Time', 'Bosnia and Herzegovina': 'Central European Standard Time', 'Botswana': 'South Africa Standard Time', 'Bouvet Island': 'UTC', 'Brazil': 'E. South America Standard Time', 'British Indian Ocean Territory': 'Central Asia Standard Time', 'Brunei': 'Singapore Standard Time', 'Bulgaria': 'FLE Standard Time', 'Burkina Faso': 'Greenwich Standard Time', 'Burundi': 'South Africa Standard Time', 'Cabo Verde': 'Cape Verde Standard Time', 'Cambodia': 'SE Asia Standard Time', 'Cameroon': 'W. Central Africa Standard Time', 'Canada': 'Eastern Standard Time', 'Cayman Islands': 'SA Pacific Standard Time', 'Central African Republic': 'W. Central Africa Standard Time', 'Chad': 'W. Central Africa Standard Time', 'Chile': 'Pacific SA Standard Time', 'China': 'China Standard Time', 'Christmas Island': 'SE Asia Standard Time', 'Cocos (Keeling) Islands': 'Myanmar Standard Time', 'Colombia': 'SA Pacific Standard Time', 'Comoros': 'E. Africa Standard Time', 'Congo': 'W. Central Africa Standard Time', 'Congo (DRC)':'W. Central Africa Standard Time', 'Cook Islands': 'Hawaiian Standard Time', 'Costa Rica': 'Central America Standard Time', "Côte d'Ivoire": 'Greenwich Standard Time', 'Croatia': 'Central European Standard Time', 'Cuba': 'Eastern Standard Time', 'Curaçao': 'SA Western Standard Time', 'Cyprus': 'E. Europe Standard Time', 'Czech Republic': 'Central Europe Standard Time', 'Democratic Republic of Timor-Leste': 'Tokyo Standard Time', 'Denmark': 'Romance Standard Time', 'Djibouti': 'E. Africa Standard Time', 'Dominica': 'SA Western Standard Time', 'Dominican Republic': 'SA Western Standard Time', 'Ecuador': 'SA Pacific Standard Time', 'Egypt': 'Egypt Standard Time', 'El Salvador': 'Central America Standard Time', 'Equatorial Guinea': 'W. Central Africa Standard Time', 'Eritrea': 'E. Africa Standard Time', 'Estonia': 'FLE Standard Time', 'Ethiopia': 'E. Africa Standard Time', 'Falkland Islands (Islas Malvinas)': 'SA Eastern Standard Time', 'Faroe Islands': 'GMT Standard Time', 'Fiji Islands': 'Fiji Standard Time', 'Finland': 'FLE Standard Time', 'France': 'Romance Standard Time', 'French Guiana': 'SA Eastern Standard Time', 'French Polynesia': 'Hawaiian Standard Time', 'French Southern and Antarctic Lands': 'West Asia Standard Time', 'Gabon': 'W. Central Africa Standard Time', 'Gambia, The': 'Greenwich Standard Time', 'Georgia': 'Georgian Standard Time', 'Germany': 'W. Europe Standard Time', 'Ghana': 'Greenwich Standard Time', 'Gibraltar': 'W. Europe Standard Time', 'Greece': 'GTB Standard Time', 'Greenland': 'Greenland Standard Time', 'Grenada': 'SA Western Standard Time', 'Guadeloupe': 'SA Western Standard Time', 'Guam': 'West Pacific Standard Time', 'Guatemala': 'Central America Standard Time', 'Guernsey': 'GMT Standard Time', 'Guinea': 'Greenwich Standard Time', 'Guinea-Bissau': 'Greenwich Standard Time', 'Guyana': 'SA Western Standard Time', 'Haiti': 'Eastern Standard Time', 'Heard Island and McDonald Islands': 'Mauritius Standard Time', 'Honduras': 'Central America Standard Time', 'Hong Kong SAR': 'China Standard Time', 'Hungary': 'Central Europe Standard Time', 'Iceland': 'Greenwich Standard Time', 'India': 'India Standard Time', 'Indonesia': 'SE Asia Standard Time', 'Iran': 'Iran Standard Time', 'Iraq': 'Arabic Standard Time', 'Ireland': 'GMT Standard Time', 'Israel': 'Israel Standard Time', 'Italy': 'W. Europe Standard Time', 
'Jamaica': 'SA Pacific Standard Time', 'Jan Mayen': 'W. Europe Standard Time', 'Japan': 'Tokyo Standard Time', 'Jersey': 'GMT Standard Time', 'Jordan': 'Jordan Standard Time', 'Kazakhstan': 'Central Asia Standard Time', 'Kenya': 'E. Africa Standard Time', 'Kiribati': 'UTC+12', 'Korea': 'Korea Standard Time', 'Kosovo': 'Central European Standard Time', 'Kuwait': 'Arab Standard Time', 'Kyrgyzstan': 'Central Asia Standard Time', 'Laos': 'SE Asia Standard Time', 'Latvia': 'FLE Standard Time', 'Lebanon': 'Middle East Standard Time', 'Lesotho': 'South Africa Standard Time', 'Liberia': 'Greenwich Standard Time', 'Libya': 'E. Europe Standard Time', 'Liechtenstein': 'W. Europe Standard Time', 'Lithuania': 'FLE Standard Time', 'Luxembourg': 'W. Europe Standard Time', 'Macao SAR': 'China Standard Time', 'Macedonia, Former Yugoslav Republic of': 'Central European Standard Time', 'Madagascar': 'E. Africa Standard Time', 'Malawi': 'South Africa Standard Time', 'Malaysia': 'Singapore Standard Time', 'Maldives': 'West Asia Standard Time', 'Mali': 'Greenwich Standard Time', 'Malta': 'W. Europe Standard Time', 'Man, Isle of': 'GMT Standard Time', 'Marshall Islands': 'UTC+12', 'Martinique': 'SA Western Standard Time', 'Mauritania': 'Greenwich Standard Time', 'Mauritius': 'Mauritius Standard Time', 'Mayotte': 'E. Africa Standard Time', 'Mexico': 'Central Standard Time (Mexico)', 'Micronesia': 'West Pacific Standard Time', 'Moldova': 'GTB Standard Time', 'Monaco': 'W. Europe Standard Time', 'Mongolia': 'Ulaanbaatar Standard Time', 'Montenegro': 'Central European Standard Time', 'Montserrat': 'SA Western Standard Time', 'Morocco': 'Morocco Standard Time', 'Mozambique': 'South Africa Standard Time', 'Myanmar': 'Myanmar Standard Time', 'Namibia': 'Namibia Standard Time', 'Nauru': 'UTC+12', 'Nepal': 'Nepal Standard Time', 'Netherlands': 'W. Europe Standard Time', 'New Caledonia': 'Central Pacific Standard Time', 'New Zealand': 'New Zealand Standard Time', 'Nicaragua': 'Central America Standard Time', 'Niger': 'W. Central Africa Standard Time', 'Nigeria': 'W. Central Africa Standard Time', 'Niue': 'UTC-11', 'Norfolk Island': 'Central Pacific Standard Time', 'North Korea': 'Korea Standard Time', 'Northern Mariana Islands': 'West Pacific Standard Time', 'Norway': 'W. Europe Standard Time', 'Oman': 'Arabian Standard Time', 'Pakistan': 'Pakistan Standard Time', 'Palau': 'Tokyo Standard Time', 'Palestinian Authority': 'Egypt Standard Time', 'Panama': 'SA Pacific Standard Time', 'Papua New Guinea': 'West Pacific Standard Time', 'Paraguay': 'Paraguay Standard Time', 'Peru': 'SA Pacific Standard Time', 'Philippines': 'Singapore Standard Time', 'Pitcairn Islands': 'Pacific Standard Time', 'Poland': 'Central European Standard Time', 'Portugal': 'GMT Standard Time', 'Puerto Rico': 'SA Western Standard Time', 'Qatar': 'Arab Standard Time', 'Reunion': 'Mauritius Standard Time', 'Romania': 'GTB Standard Time', 'Russia': 'Russian Standard Time', 'Rwanda': 'South Africa Standard Time', 'Saint Barthélemy': 'SA Western Standard Time', 'Saint Helena, Ascension and Tristan da Cunha': 'Greenwich Standard Time', 'Saint Kitts and Nevis': 'SA Western Standard Time', 'Saint Lucia': 'SA Western Standard Time', 'Saint Martin (French part)': 'SA Western Standard Time', 'Saint Pierre and Miquelon': 'Greenland Standard Time', 'Saint Vincent and the Grenadines': 'SA Western Standard Time', 'Samoa': 'Samoa Standard Time', 'San Marino': 'W. Europe Standard Time', 'São Tomé and Príncipe': 'Greenwich Standard Time', 'Saudi Arabia': 'Arab Standard Time', 'Senegal': 'Greenwich Standard Time', 'Serbia': 'Central Europe Standard Time', 'Seychelles': 'Mauritius Standard Time', 'Sierra Leone': 'Greenwich Standard Time', 'Singapore': 'Singapore Standard Time', 'Sint Maarten (Dutch part)': 'SA Western Standard Time', 'Slovakia': 'Central Europe Standard Time', 'Slovenia': 'Central Europe Standard Time', 'Solomon Islands': 'Central Pacific Standard Time', 'Somalia': 'E. Africa Standard Time', 'South Africa': 'South Africa Standard Time', 'South Georgia and the South Sandwich Islands': 'UTC-02', 'South Sudan': 'E. Africa Standard Time', 'Spain': 'Romance Standard Time', 'Sri Lanka': 'Sri Lanka Standard Time', 'Sudan': 'E. Africa Standard Time', 'Suriname': 'SA Eastern Standard Time', 'Svalbard': 'W. Europe Standard Time', 'Swaziland': 'South Africa Standard Time', 'Sweden': 'W. Europe Standard Time', 'Switzerland': 'W. Europe Standard Time', 'Syria': 'Syria Standard Time', 'Taiwan': 'Taipei Standard Time', 'Tajikistan': 'West Asia Standard Time', 'Tanzania': 'E. Africa Standard Time', 'Thailand': 'SE Asia Standard Time', 'Togo': 'Greenwich Standard Time', 'Tokelau': 'Tonga Standard Time', 'Tonga': 'Tonga Standard Time', 'Trinidad and Tobago': 'SA Western Standard Time', 'Tunisia': 'W. Central Africa Standard Time', 'Turkey': 'Turkey Standard Time', 'Turkmenistan': 'West Asia Standard Time', 'Turks and Caicos Islands': 'Eastern Standard Time', 'Tuvalu': 'UTC+12', 'U.S. Minor Outlying Islands': 'UTC-11', 'Uganda': 'E. Africa Standard Time', 'Ukraine': 'FLE Standard Time', 'United Arab Emirates': 'Arabian Standard Time', 'United Kingdom': 'GMT Standard Time', 'United States': 'Pacific Standard Time', 'Uruguay': 'Montevideo Standard Time', 'Uzbekistan': 'West Asia Standard Time', 'Vanuatu': 'Central Pacific Standard Time', 'Vatican City': 'W. Europe Standard Time', 'Vietnam': 'SE Asia Standard Time', 'Virgin Islands, U.S.': 'SA Western Standard Time', 'Virgin Islands, British': 'SA Western Standard Time', 'Wallis and Futuna': 'UTC+12', 'Yemen': 'Arab Standard Time', 'Zambia': 'South Africa Standard Time', 'Zimbabwe': 'South Africa Standard Time'}

if proxy_country in country_timezones:
    # Retrieve the corresponding timezone
    timezone = country_timezones[proxy_country]

    # Set the system timezone
    set_system_timezone_windows(timezone)
else:
    print("Proxy country mapping not found.")

# Rest of your Selenium code...
